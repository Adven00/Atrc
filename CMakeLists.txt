CMAKE_MINIMUM_REQUIRED(VERSION 3.13)

IF(DEFINED ENV{VCPKG_ROOT} AND NOT DEFINED CMAKE_TOOLCHAIN_FILE)
  SET(CMAKE_TOOLCHAIN_FILE $ENV{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake CACHE STRING "")
ENDIF()

PROJECT(Atrc)

INCLUDE_DIRECTORIES($ENV{AGZ_UTILS_HOME})
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/Source/)

SET(CMAKE_CXX_STANDARD 17)

IF(MSVC)
    ADD_DEFINITIONS(-D_CRT_SECURE_NO_WARNINGS)
ENDIF()

FIND_PACKAGE(OpenGL REQUIRED)
FIND_PACKAGE(glfw3 CONFIG REQUIRED)
FIND_PACKAGE(GLEW REQUIRED)

FILE(GLOB_RECURSE LIB_SRC "Source/Atrc/Lib/*.cpp" "Source/Atrc/Lib/*.h")
ADD_LIBRARY(Lib STATIC ${LIB_SRC} ${LIB_HDR})

FILE(GLOB_RECURSE MGR_SRC "Source/Atrc/Mgr/*.cpp" "Source/Atrc/Mgr/*.h")
ADD_LIBRARY(Mgr STATIC ${MGR_SRC})

FILE(GLOB_RECURSE IMGUI_SRC "Source/Lib/imgui/*.cpp" "Source/Lib/imgui/*.h")
ADD_LIBRARY(ImGui STATIC ${IMGUI_SRC})
TARGET_INCLUDE_DIRECTORIES(ImGui PRIVATE ${GLEW_INCLUDE_DIRS})
TARGET_INCLUDE_DIRECTORIES(ImGui PRIVATE ${glfw3_INCLUDE_DIRS})

FILE(GLOB_RECURSE LAUNCHER_SRC "Source/Atrc/Launcher/*.cpp" "Source/Atrc/Launcher/*.h")
ADD_EXECUTABLE(Launcher ${LAUNCHER_SRC})
TARGET_LINK_LIBRARIES(Launcher Lib Mgr)

FILE(GLOB_RECURSE MODELVIEWER_SRC "Source/Atrc/ModelViewer/*.cpp" "Source/Atrc/ModelViewer/*.h")
ADD_EXECUTABLE(ModelViewer ${MODELVIEWER_SRC})

TARGET_INCLUDE_DIRECTORIES(ModelViewer PRIVATE ${GLEW_INCLUDE_DIRS})
TARGET_INCLUDE_DIRECTORIES(ModelViewer PRIVATE ${glfw3_INCLUDE_DIRS})
TARGET_INCLUDE_DIRECTORIES(ModelViewer PRIVATE ${OPENGL_INCLUDE_DIRS})

TARGET_LINK_LIBRARIES(ModelViewer ImGui)
TARGET_LINK_LIBRARIES(ModelViewer GLEW::GLEW)
TARGET_LINK_LIBRARIES(ModelViewer glfw)
TARGET_LINK_LIBRARIES(ModelViewer ${OPENGL_LIBRARIES})
