#include <Atrc/Lib/Material/BSSRDF/NormalizedDiffusionBSSRDF.h>

namespace Atrc
{

NormalizedDiffusionBSSRDF::NormalizedDiffusionBSSRDF(
    const Intersection &inct, Real eta, const Spectrum &A, const Spectrum &mfp) noexcept
    : SeparableBSSRDF(inct, eta), A_(A), l_(mfp)
{
    s_ = -A + Real(1.9) + Real(3.5) * (A - Real(0.8)).Map([](Real c) { return c * c; });
}

Spectrum NormalizedDiffusionBSSRDF::Sr(Real distance) const noexcept
{
    Spectrum dis = Spectrum(distance) / l_;
    Spectrum a = (-s_ * dis).Map(Exp<Real>) + (-s_ * dis / 3).Map(Exp<Real>);
    Spectrum b(8 * PI * dis);
    return A_ * s_ * a / b;
}

namespace
{
    const Real INV_CDF_TAB[] =
    {
        0.000000,  0.000977,  0.001955,  0.002934,  0.003913,  0.004893,  0.005874,  0.006855,
        0.007837,  0.008819,  0.009802,  0.010786,  0.011771,  0.012756,  0.013741,  0.014728,
        0.015715,  0.016702,  0.017691,  0.018679,  0.019669,  0.020659,  0.021650,  0.022642,
        0.023634,  0.024627,  0.025620,  0.026614,  0.027609,  0.028605,  0.029601,  0.030598,
        0.031595,  0.032593,  0.033592,  0.034591,  0.035592,  0.036592,  0.037594,  0.038596,
        0.039599,  0.040602,  0.041606,  0.042611,  0.043616,  0.044622,  0.045629,  0.046637,
        0.047645,  0.048653,  0.049663,  0.050673,  0.051684,  0.052695,  0.053707,  0.054720,
        0.055734,  0.056748,  0.057763,  0.058778,  0.059795,  0.060812,  0.061829,  0.062847,
        0.063866,  0.064886,  0.065906,  0.066927,  0.067949,  0.068972,  0.069995,  0.071018,
        0.072043,  0.073068,  0.074094,  0.075120,  0.076148,  0.077176,  0.078204,  0.079234,
        0.080264,  0.081294,  0.082326,  0.083358,  0.084391,  0.085424,  0.086458,  0.087493,
        0.088529,  0.089565,  0.090602,  0.091640,  0.092679,  0.093718,  0.094758,  0.095798,
        0.096840,  0.097882,  0.098924,  0.099968,  0.101012,  0.102057,  0.103102,  0.104149,
        0.105196,  0.106243,  0.107292,  0.108341,  0.109391,  0.110442,  0.111493,  0.112545,
        0.113598,  0.114651,  0.115705,  0.116760,  0.117816,  0.118873,  0.119930,  0.120988,
        0.122046,  0.123106,  0.124166,  0.125226,  0.126288,  0.127350,  0.128413,  0.129477,
        0.130542,  0.131607,  0.132673,  0.133740,  0.134807,  0.135875,  0.136944,  0.138014,
        0.139084,  0.140155,  0.141227,  0.142300,  0.143374,  0.144448,  0.145523,  0.146598,
        0.147675,  0.148752,  0.149830,  0.150909,  0.151988,  0.153068,  0.154149,  0.155231,
        0.156314,  0.157397,  0.158481,  0.159566,  0.160651,  0.161737,  0.162825,  0.163912,
        0.165001,  0.166090,  0.167181,  0.168271,  0.169363,  0.170456,  0.171549,  0.172643,
        0.173738,  0.174833,  0.175930,  0.177027,  0.178125,  0.179223,  0.180323,  0.181423,
        0.182524,  0.183626,  0.184729,  0.185832,  0.186936,  0.188041,  0.189147,  0.190253,
        0.191361,  0.192469,  0.193578,  0.194687,  0.195798,  0.196909,  0.198021,  0.199134,
        0.200248,  0.201362,  0.202478,  0.203594,  0.204711,  0.205828,  0.206947,  0.208066,
        0.209186,  0.210307,  0.211429,  0.212552,  0.213675,  0.214799,  0.215924,  0.217050,
        0.218177,  0.219304,  0.220432,  0.221561,  0.222691,  0.223822,  0.224953,  0.226086,
        0.227219,  0.228353,  0.229488,  0.230623,  0.231760,  0.232897,  0.234035,  0.235174,
        0.236314,  0.237455,  0.238596,  0.239739,  0.240882,  0.242026,  0.243170,  0.244316,
        0.245463,  0.246610,  0.247758,  0.248907,  0.250057,  0.251208,  0.252359,  0.253512,
        0.254665,  0.255819,  0.256974,  0.258130,  0.259286,  0.260444,  0.261602,  0.262761,
        0.263921,  0.265082,  0.266244,  0.267407,  0.268570,  0.269735,  0.270900,  0.272066,
        0.273233,  0.274401,  0.275570,  0.276739,  0.277910,  0.279081,  0.280253,  0.281426,
        0.282600,  0.283775,  0.284951,  0.286127,  0.287305,  0.288483,  0.289662,  0.290842,
        0.292023,  0.293205,  0.294388,  0.295572,  0.296756,  0.297942,  0.299128,  0.300315,
        0.301503,  0.302692,  0.303882,  0.305073,  0.306265,  0.307457,  0.308651,  0.309845,
        0.311040,  0.312237,  0.313434,  0.314632,  0.315831,  0.317030,  0.318231,  0.319433,
        0.320635,  0.321839,  0.323043,  0.324248,  0.325455,  0.326662,  0.327870,  0.329079,
        0.330289,  0.331500,  0.332711,  0.333924,  0.335138,  0.336352,  0.337568,  0.338784,
        0.340001,  0.341219,  0.342439,  0.343659,  0.344880,  0.346102,  0.347325,  0.348549,
        0.349773,  0.350999,  0.352226,  0.353454,  0.354682,  0.355912,  0.357142,  0.358374,
        0.359606,  0.360839,  0.362074,  0.363309,  0.364545,  0.365782,  0.367020,  0.368259,
        0.369500,  0.370741,  0.371983,  0.373225,  0.374469,  0.375714,  0.376960,  0.378207,
        0.379455,  0.380703,  0.381953,  0.383204,  0.384456,  0.385708,  0.386962,  0.388217,
        0.389472,  0.390729,  0.391986,  0.393245,  0.394504,  0.395765,  0.397027,  0.398289,
        0.399553,  0.400817,  0.402083,  0.403349,  0.404617,  0.405885,  0.407155,  0.408425,
        0.409697,  0.410969,  0.412243,  0.413517,  0.414793,  0.416069,  0.417347,  0.418626,
        0.419905,  0.421186,  0.422467,  0.423750,  0.425034,  0.426318,  0.427604,  0.428891,
        0.430179,  0.431468,  0.432757,  0.434048,  0.435340,  0.436633,  0.437927,  0.439222,
        0.440518,  0.441815,  0.443113,  0.444412,  0.445713,  0.447014,  0.448316,  0.449619,
        0.450924,  0.452229,  0.453536,  0.454843,  0.456152,  0.457461,  0.458772,  0.460084,
        0.461397,  0.462711,  0.464026,  0.465342,  0.466659,  0.467977,  0.469296,  0.470616,
        0.471938,  0.473260,  0.474584,  0.475908,  0.477234,  0.478561,  0.479889,  0.481218,
        0.482548,  0.483879,  0.485211,  0.486544,  0.487878,  0.489214,  0.490550,  0.491888,
        0.493227,  0.494567,  0.495908,  0.497250,  0.498593,  0.499937,  0.501282,  0.502629,
        0.503976,  0.505325,  0.506675,  0.508026,  0.509378,  0.510731,  0.512085,  0.513440,
        0.514797,  0.516155,  0.517513,  0.518873,  0.520234,  0.521596,  0.522960,  0.524324,
        0.525690,  0.527056,  0.528424,  0.529793,  0.531163,  0.532534,  0.533907,  0.535280,
        0.536655,  0.538031,  0.539408,  0.540786,  0.542165,  0.543545,  0.544927,  0.546310,
        0.547694,  0.549079,  0.550465,  0.551852,  0.553241,  0.554631,  0.556021,  0.557414,
        0.558807,  0.560201,  0.561597,  0.562994,  0.564392,  0.565791,  0.567191,  0.568593,
        0.569995,  0.571399,  0.572804,  0.574211,  0.575618,  0.577027,  0.578437,  0.579848,
        0.581260,  0.582673,  0.584088,  0.585504,  0.586921,  0.588339,  0.589759,  0.591180,
        0.592602,  0.594025,  0.595449,  0.596875,  0.598302,  0.599730,  0.601159,  0.602589,
        0.604021,  0.605454,  0.606888,  0.608324,  0.609760,  0.611198,  0.612637,  0.614078,
        0.615520,  0.616962,  0.618407,  0.619852,  0.621299,  0.622746,  0.624196,  0.625646,
        0.627098,  0.628551,  0.630005,  0.631460,  0.632917,  0.634375,  0.635834,  0.637295,
        0.638757,  0.640220,  0.641684,  0.643150,  0.644617,  0.646085,  0.647554,  0.649025,
        0.650497,  0.651971,  0.653445,  0.654921,  0.656398,  0.657877,  0.659357,  0.660838,
        0.662320,  0.663804,  0.665289,  0.666776,  0.668263,  0.669752,  0.671243,  0.672734,
        0.674227,  0.675722,  0.677217,  0.678714,  0.680212,  0.681712,  0.683213,  0.684715,
        0.686219,  0.687724,  0.689230,  0.690738,  0.692247,  0.693757,  0.695269,  0.696782,
        0.698296,  0.699812,  0.701329,  0.702847,  0.704367,  0.705888,  0.707411,  0.708935,
        0.710460,  0.711987,  0.713515,  0.715044,  0.716575,  0.718107,  0.719641,  0.721176,
        0.722712,  0.724250,  0.725789,  0.727329,  0.728871,  0.730414,  0.731959,  0.733505,
        0.735053,  0.736602,  0.738152,  0.739704,  0.741257,  0.742811,  0.744367,  0.745925,
        0.747483,  0.749044,  0.750605,  0.752168,  0.753733,  0.755299,  0.756866,  0.758435,
        0.760005,  0.761577,  0.763150,  0.764725,  0.766301,  0.767878,  0.769457,  0.771037,
        0.772619,  0.774203,  0.775787,  0.777374,  0.778961,  0.780550,  0.782141,  0.783733,
        0.785327,  0.786922,  0.788518,  0.790116,  0.791716,  0.793317,  0.794919,  0.796523,
        0.798129,  0.799736,  0.801344,  0.802954,  0.804566,  0.806178,  0.807793,  0.809409,
        0.811026,  0.812645,  0.814266,  0.815888,  0.817512,  0.819137,  0.820763,  0.822392,
        0.824021,  0.825652,  0.827285,  0.828920,  0.830555,  0.832193,  0.833832,  0.835472,
        0.837114,  0.838758,  0.840403,  0.842050,  0.843698,  0.845348,  0.846999,  0.848652,
        0.850307,  0.851963,  0.853621,  0.855280,  0.856941,  0.858603,  0.860267,  0.861933,
        0.863600,  0.865269,  0.866939,  0.868611,  0.870285,  0.871960,  0.873637,  0.875315,
        0.876995,  0.878677,  0.880360,  0.882045,  0.883732,  0.885420,  0.887110,  0.888801,
        0.890494,  0.892189,  0.893885,  0.895583,  0.897283,  0.898984,  0.900687,  0.902391,
        0.904098,  0.905805,  0.907515,  0.909226,  0.910939,  0.912654,  0.914370,  0.916088,
        0.917807,  0.919528,  0.921251,  0.922976,  0.924702,  0.926430,  0.928160,  0.929891,
        0.931624,  0.933359,  0.935096,  0.936834,  0.938574,  0.940315,  0.942059,  0.943804,
        0.945551,  0.947299,  0.949049,  0.950801,  0.952555,  0.954311,  0.956068,  0.957827,
        0.959587,  0.961350,  0.963114,  0.964880,  0.966647,  0.968417,  0.970188,  0.971961,
        0.973736,  0.975512,  0.977291,  0.979071,  0.980853,  0.982636,  0.984422,  0.986209,
        0.987998,  0.989789,  0.991581,  0.993376,  0.995172,  0.996970,  0.998770,  1.000571,
        1.002375,  1.004180,  1.005987,  1.007796,  1.009607,  1.011419,  1.013234,  1.015050,
        1.016868,  1.018688,  1.020510,  1.022334,  1.024159,  1.025987,  1.027816,  1.029647,
        1.031480,  1.033315,  1.035151,  1.036990,  1.038830,  1.040673,  1.042517,  1.044363,
        1.046211,  1.048061,  1.049913,  1.051767,  1.053622,  1.055480,  1.057339,  1.059201,
        1.061064,  1.062929,  1.064796,  1.066665,  1.068536,  1.070409,  1.072284,  1.074161,
        1.076040,  1.077921,  1.079803,  1.081688,  1.083575,  1.085463,  1.087354,  1.089246,
        1.091141,  1.093037,  1.094936,  1.096836,  1.098738,  1.100643,  1.102549,  1.104458,
        1.106368,  1.108280,  1.110195,  1.112111,  1.114030,  1.115950,  1.117873,  1.119797,
        1.121724,  1.123652,  1.125583,  1.127515,  1.129450,  1.131387,  1.133326,  1.135267,
        1.137209,  1.139154,  1.141102,  1.143051,  1.145002,  1.146955,  1.148910,  1.150868,
        1.152827,  1.154789,  1.156753,  1.158719,  1.160687,  1.162657,  1.164629,  1.166603,
        1.168579,  1.170558,  1.172538,  1.174521,  1.176506,  1.178493,  1.180482,  1.182474,
        1.184467,  1.186463,  1.188461,  1.190461,  1.192463,  1.194467,  1.196473,  1.198482,
        1.200493,  1.202506,  1.204521,  1.206538,  1.208558,  1.210580,  1.212604,  1.214630,
        1.216658,  1.218689,  1.220722,  1.222757,  1.224794,  1.226834,  1.228876,  1.230920,
        1.232966,  1.235014,  1.237065,  1.239118,  1.241174,  1.243231,  1.245291,  1.247353,
        1.249417,  1.251484,  1.253553,  1.255624,  1.257698,  1.259774,  1.261852,  1.263932,
        1.266015,  1.268100,  1.270188,  1.272277,  1.274370,  1.276464,  1.278561,  1.280660,
        1.282761,  1.284865,  1.286971,  1.289080,  1.291191,  1.293304,  1.295420,  1.297538,
        1.299658,  1.301781,  1.303906,  1.306034,  1.308163,  1.310296,  1.312431,  1.314568,
        1.316708,  1.318850,  1.320994,  1.323141,  1.325290,  1.327442,  1.329596,  1.331753,
        1.333912,  1.336074,  1.338238,  1.340405,  1.342574,  1.344745,  1.346919,  1.349096,
        1.351275,  1.353456,  1.355640,  1.357827,  1.360016,  1.362207,  1.364401,  1.366598,
        1.368797,  1.370999,  1.373203,  1.375410,  1.377619,  1.379831,  1.382045,  1.384262,
        1.386482,  1.388704,  1.390929,  1.393156,  1.395386,  1.397618,  1.399854,  1.402091,
        1.404332,  1.406575,  1.408820,  1.411068,  1.413319,  1.415573,  1.417829,  1.420088,
        1.422349,  1.424613,  1.426880,  1.429149,  1.431421,  1.433696,  1.435974,  1.438254,
        1.440537,  1.442822,  1.445111,  1.447401,  1.449695,  1.451992,  1.454291,  1.456593,
        1.458897,  1.461205,  1.463515,  1.465828,  1.468143,  1.470462,  1.472783,  1.475107,
        1.477434,  1.479763,  1.482095,  1.484431,  1.486768,  1.489109,  1.491453,  1.493799,
        1.496148,  1.498500,  1.500855,  1.503213,  1.505574,  1.507937,  1.510303,  1.512673,
        1.515045,  1.517419,  1.519797,  1.522178,  1.524562,  1.526948,  1.529338,  1.531730,
        1.534125,  1.536523,  1.538924,  1.541328,  1.543735,  1.546145,  1.548558,  1.550974,
        1.553393,  1.555815,  1.558240,  1.560667,  1.563098,  1.565532,  1.567969,  1.570409,
        1.572851,  1.575297,  1.577746,  1.580198,  1.582653,  1.585111,  1.587572,  1.590036,
        1.592503,  1.594974,  1.597447,  1.599924,  1.602403,  1.604886,  1.607371,  1.609860,
        1.612352,  1.614847,  1.617346,  1.619847,  1.622352,  1.624859,  1.627370,  1.629884,
        1.632401,  1.634922,  1.637445,  1.639972,  1.642502,  1.645035,  1.647572,  1.650111,
        1.652654,  1.655200,  1.657749,  1.660302,  1.662858,  1.665417,  1.667979,  1.670545,
        1.673114,  1.675686,  1.678261,  1.680840,  1.683422,  1.686008,  1.688596,  1.691188,
        1.693784,  1.696382,  1.698985,  1.701590,  1.704199,  1.706811,  1.709427,  1.712046,
        1.714668,  1.717294,  1.719923,  1.722556,  1.725192,  1.727831,  1.730474,  1.733121,
        1.735770,  1.738424,  1.741080,  1.743741,  1.746404,  1.749072,  1.751742,  1.754417,
        1.757094,  1.759776,  1.762461,  1.765149,  1.767841,  1.770536,  1.773235,  1.775938,
        1.778644,  1.781354,  1.784067,  1.786784,  1.789505,  1.792229,  1.794957,  1.797688,
        1.800424,  1.803162,  1.805905,  1.808651,  1.811401,  1.814154,  1.816911,  1.819672,
        1.822437,  1.825205,  1.827977,  1.830753,  1.833532,  1.836316,  1.839103,  1.841893,
        1.844688,  1.847486,  1.850288,  1.853094,  1.855904,  1.858718,  1.861535,  1.864356,
        1.867181,  1.870010,  1.872843,  1.875680,  1.878520,  1.881365,  1.884213,  1.887065,
        1.889922,  1.892782,  1.895646,  1.898514,  1.901386,  1.904262,  1.907141,  1.910025,
        1.912913,  1.915805,  1.918701,  1.921601,  1.924505,  1.927412,  1.930324,  1.933241,
        1.936161,  1.939085,  1.942013,  1.944945,  1.947882,  1.950822,  1.953767,  1.956716,
        1.959669,  1.962626,  1.965587,  1.968553,  1.971522,  1.974496,  1.977474,  1.980456,
        1.983443,  1.986434,  1.989428,  1.992428,  1.995431,  1.998439,  2.001451,  2.004467,
        2.007488,  2.010512,  2.013542,  2.016575,  2.019613,  2.022655,  2.025702,  2.028753,
        2.031808,  2.034868,  2.037932,  2.041001,  2.044074,  2.047151,  2.050233,  2.053319,
        2.056410,  2.059505,  2.062605,  2.065709,  2.068818,  2.071932,  2.075049,  2.078172,
        2.081299,  2.084430,  2.087566,  2.090707,  2.093852,  2.097002,  2.100157,  2.103316,
        2.106480,  2.109648,  2.112821,  2.115999,  2.119182,  2.122369,  2.125561,  2.128758,
        2.131959,  2.135165,  2.138376,  2.141592,  2.144812,  2.148038,  2.151268,  2.154503,
        2.157742,  2.160987,  2.164236,  2.167491,  2.170750,  2.174014,  2.177283,  2.180557,
        2.183836,  2.187120,  2.190409,  2.193702,  2.197001,  2.200305,  2.203614,  2.206927,
        2.210246,  2.213570,  2.216899,  2.220233,  2.223572,  2.226916,  2.230266,  2.233620,
        2.236980,  2.240344,  2.243714,  2.247089,  2.250470,  2.253855,  2.257246,  2.260642,
        2.264043,  2.267449,  2.270861,  2.274278,  2.277700,  2.281128,  2.284561,  2.287999,
        2.291442,  2.294891,  2.298346,  2.301806,  2.305271,  2.308741,  2.312218,  2.315699,
        2.319186,  2.322679,  2.326176,  2.329680,  2.333189,  2.336704,  2.340224,  2.343749,
        2.347281,  2.350818,  2.354360,  2.357908,  2.361462,  2.365021,  2.368587,  2.372157,
        2.375734,  2.379316,  2.382904,  2.386498,  2.390097,  2.393703,  2.397314,  2.400931,
        2.404554,  2.408182,  2.411817,  2.415457,  2.419103,  2.422756,  2.426414,  2.430078,
        2.433748,  2.437424,  2.441106,  2.444794,  2.448488,  2.452188,  2.455894,  2.459606,
        2.463325,  2.467049,  2.470780,  2.474516,  2.478259,  2.482008,  2.485764,  2.489525,
        2.493293,  2.497067,  2.500847,  2.504633,  2.508426,  2.512225,  2.516031,  2.519843,
        2.523661,  2.527486,  2.531317,  2.535154,  2.538998,  2.542848,  2.546705,  2.550569,
        2.554438,  2.558315,  2.562198,  2.566087,  2.569984,  2.573886,  2.577796,  2.581712,
        2.585635,  2.589564,  2.593500,  2.597443,  2.601393,  2.605349,  2.609312,  2.613282,
        2.617259,  2.621243,  2.625233,  2.629231,  2.633235,  2.637247,  2.641265,  2.645290,
        2.649322,  2.653362,  2.657408,  2.661461,  2.665522,  2.669589,  2.673664,  2.677745,
        2.681834,  2.685930,  2.690034,  2.694144,  2.698262,  2.702387,  2.706520,  2.710659,
        2.714806,  2.718961,  2.723122,  2.727291,  2.731468,  2.735652,  2.739844,  2.744042,
        2.748249,  2.752463,  2.756685,  2.760914,  2.765151,  2.769395,  2.773647,  2.777907,
        2.782174,  2.786450,  2.790732,  2.795023,  2.799322,  2.803628,  2.807942,  2.812264,
        2.816594,  2.820932,  2.825278,  2.829632,  2.833994,  2.838363,  2.842741,  2.847127,
        2.851521,  2.855923,  2.860334,  2.864752,  2.869179,  2.873614,  2.878057,  2.882508,
        2.886968,  2.891436,  2.895913,  2.900398,  2.904891,  2.909392,  2.913903,  2.918421,
        2.922948,  2.927484,  2.932029,  2.936581,  2.941143,  2.945713,  2.950292,  2.954880,
        2.959476,  2.964081,  2.968695,  2.973318,  2.977950,  2.982590,  2.987240,  2.991898,
        2.996566,  3.001242,  3.005928,  3.010622,  3.015326,  3.020039,  3.024761,  3.029492,
        3.034232,  3.038982,  3.043741,  3.048509,  3.053287,  3.058074,  3.062870,  3.067676,
        3.072491,  3.077316,  3.082151,  3.086995,  3.091848,  3.096711,  3.101584,  3.106467,
        3.111359,  3.116262,  3.121174,  3.126095,  3.131027,  3.135969,  3.140920,  3.145882,
        3.150853,  3.155835,  3.160827,  3.165829,  3.170841,  3.175863,  3.180895,  3.185938,
        3.190991,  3.196054,  3.201128,  3.206212,  3.211307,  3.216412,  3.221528,  3.226654,
        3.231791,  3.236938,  3.242096,  3.247265,  3.252445,  3.257635,  3.262837,  3.268049,
        3.273272,  3.278506,  3.283751,  3.289007,  3.294274,  3.299552,  3.304842,  3.310142,
        3.315454,  3.320778,  3.326112,  3.331458,  3.336815,  3.342184,  3.347564,  3.352956,
        3.358360,  3.363775,  3.369201,  3.374640,  3.380090,  3.385552,  3.391026,  3.396511,
        3.402009,  3.407519,  3.413041,  3.418574,  3.424120,  3.429678,  3.435249,  3.440831,
        3.446426,  3.452034,  3.457653,  3.463286,  3.468930,  3.474588,  3.480257,  3.485940,
        3.491635,  3.497343,  3.503064,  3.508798,  3.514544,  3.520304,  3.526076,  3.531862,
        3.537661,  3.543473,  3.549298,  3.555136,  3.560988,  3.566853,  3.572732,  3.578624,
        3.584530,  3.590449,  3.596382,  3.602329,  3.608289,  3.614263,  3.620252,  3.626254,
        3.632270,  3.638300,  3.644344,  3.650403,  3.656476,  3.662563,  3.668664,  3.674780,
        3.680910,  3.687055,  3.693215,  3.699389,  3.705578,  3.711781,  3.718000,  3.724233,
        3.730482,  3.736745,  3.743024,  3.749317,  3.755626,  3.761951,  3.768290,  3.774646,
        3.781016,  3.787402,  3.793804,  3.800222,  3.806655,  3.813105,  3.819570,  3.826051,
        3.832548,  3.839061,  3.845591,  3.852137,  3.858699,  3.865278,  3.871873,  3.878485,
        3.885113,  3.891758,  3.898420,  3.905099,  3.911795,  3.918508,  3.925238,  3.931985,
        3.938749,  3.945531,  3.952330,  3.959147,  3.965981,  3.972833,  3.979703,  3.986591,
        3.993496,  4.000420,  4.007361,  4.014321,  4.021299,  4.028296,  4.035311,  4.042344,
        4.049396,  4.056467,  4.063557,  4.070665,  4.077793,  4.084939,  4.092105,  4.099290,
        4.106494,  4.113718,  4.120962,  4.128225,  4.135508,  4.142810,  4.150133,  4.157475,
        4.164838,  4.172221,  4.179624,  4.187048,  4.194493,  4.201958,  4.209443,  4.216950,
        4.224478,  4.232026,  4.239596,  4.247187,  4.254800,  4.262434,  4.270090,  4.277767,
        4.285467,  4.293188,  4.300931,  4.308697,  4.316485,  4.324295,  4.332128,  4.339983,
        4.347862,  4.355763,  4.363687,  4.371635,  4.379606,  4.387600,  4.395617,  4.403659,
        4.411724,  4.419813,  4.427926,  4.436064,  4.444225,  4.452411,  4.460622,  4.468858,
        4.477118,  4.485403,  4.493714,  4.502050,  4.510411,  4.518798,  4.527210,  4.535649,
        4.544113,  4.552604,  4.561120,  4.569664,  4.578234,  4.586831,  4.595454,  4.604105,
        4.612783,  4.621488,  4.630221,  4.638982,  4.647771,  4.656587,  4.665432,  4.674306,
        4.683207,  4.692138,  4.701098,  4.710086,  4.719104,  4.728151,  4.737228,  4.746335,
        4.755471,  4.764638,  4.773836,  4.783063,  4.792322,  4.801611,  4.810932,  4.820284,
        4.829667,  4.839082,  4.848529,  4.858008,  4.867519,  4.877063,  4.886640,  4.896250,
        4.905892,  4.915569,  4.925278,  4.935022,  4.944800,  4.954612,  4.964458,  4.974339,
        4.984255,  4.994206,  5.004193,  5.014215,  5.024273,  5.034368,  5.044498,  5.054666,
        5.064870,  5.075111,  5.085390,  5.095706,  5.106061,  5.116453,  5.126884,  5.137354,
        5.147862,  5.158410,  5.168998,  5.179625,  5.190292,  5.201000,  5.211749,  5.222538,
        5.233369,  5.244241,  5.255155,  5.266112,  5.277110,  5.288152,  5.299237,  5.310365,
        5.321537,  5.332753,  5.344014,  5.355319,  5.366670,  5.378066,  5.389507,  5.400995,
        5.412530,  5.424111,  5.435740,  5.447416,  5.459140,  5.470912,  5.482734,  5.494604,
        5.506524,  5.518494,  5.530514,  5.542585,  5.554707,  5.566880,  5.579106,  5.591384,
        5.603714,  5.616098,  5.628536,  5.641028,  5.653575,  5.666176,  5.678833,  5.691547,
        5.704316,  5.717143,  5.730027,  5.742969,  5.755970,  5.769029,  5.782148,  5.795328,
        5.808567,  5.821868,  5.835230,  5.848655,  5.862142,  5.875693,  5.889307,  5.902986,
        5.916730,  5.930540,  5.944416,  5.958359,  5.972370,  5.986448,  6.000596,  6.014812,
        6.029099,  6.043457,  6.057886,  6.072388,  6.086962,  6.101610,  6.116332,  6.131129,
        6.146002,  6.160952,  6.175978,  6.191083,  6.206267,  6.221531,  6.236874,  6.252300,
        6.267807,  6.283398,  6.299072,  6.314831,  6.330676,  6.346607,  6.362626,  6.378733,
        6.394930,  6.411217,  6.427596,  6.444066,  6.460631,  6.477289,  6.494043,  6.510894,
        6.527842,  6.544889,  6.562036,  6.579284,  6.596635,  6.614088,  6.631646,  6.649310,
        6.667082,  6.684961,  6.702950,  6.721050,  6.739263,  6.757589,  6.776031,  6.794588,
        6.813264,  6.832060,  6.850976,  6.870015,  6.889178,  6.908466,  6.927882,  6.947427,
        6.967103,  6.986911,  7.006853,  7.026931,  7.047147,  7.067502,  7.087999,  7.108639,
        7.129425,  7.150359,  7.171442,  7.192677,  7.214066,  7.235610,  7.257314,  7.279177,
        7.301204,  7.323396,  7.345757,  7.368287,  7.390991,  7.413870,  7.436927,  7.460166,
        7.483589,  7.507198,  7.530997,  7.554989,  7.579177,  7.603564,  7.628154,  7.652949,
        7.677953,  7.703170,  7.728604,  7.754257,  7.780134,  7.806239,  7.832575,  7.859148,
        7.885960,  7.913016,  7.940322,  7.967880,  7.995697,  8.023777,  8.052124,  8.080744,
        8.109643,  8.138825,  8.168296,  8.198063,  8.228130,  8.258504,  8.289191,  8.320198,
        8.351532,  8.383198,  8.415205,  8.447560,  8.480270,  8.513343,  8.546788,  8.580612,
        8.614824,  8.649433,  8.684449,  8.719881,  8.755739,  8.792034,  8.828775,  8.865975,
        8.903644,  8.941795,  8.980440,  9.019591,  9.059263,  9.099469,  9.140224,  9.181543,
        9.223441,  9.265935,  9.309043,  9.352781,  9.397169,  9.442227,  9.487974,  9.534432,
        9.581623,  9.629571,  9.678301,  9.727837,  9.778208,  9.829442,  9.881569,  9.934620,
        9.988628,  10.043629, 10.099660, 10.156761, 10.214971, 10.274336, 10.334902, 10.396719,
        10.459839, 10.524318, 10.590217, 10.657597, 10.726529, 10.797085, 10.869342, 10.943386,
        11.019306, 11.097199, 11.177172, 11.259338, 11.343821, 11.430754, 11.520285, 11.612572,
        11.707792, 11.806135, 11.907815, 12.013065, 12.122144, 12.235343, 12.352983, 12.475428,
        12.603087, 12.736423, 12.875965, 13.022318, 13.176182, 13.338368, 13.509828, 13.691688,
        13.885290, 14.092257, 14.314569, 14.554687, 14.815711, 15.101633, 15.417706, 15.771048,
        16.171636, 16.634082, 17.181042, 17.850469, 18.713512, 19.929906, 22.009346, 111.686674,
    };

    constexpr int SIZE_OF_INV_CDF_TAB = AGZ::ArraySize(INV_CDF_TAB);
}

} // namespace Atrc
